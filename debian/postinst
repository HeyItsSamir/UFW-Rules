#!/bin/sh -e

. /usr/share/debconf/confmodule

BEFORE_FILE="/etc/ufw/before.rules"
BEFORE_FILE_TEMPLATE="/usr/share/ufw/before.rules"
AFTER_FILE="/etc/ufw/after.rules"
AFTER_FILE_TEMPLATE="/usr/share/ufw/after.rules"
case "$1" in
    configure)
	if [ -e "/etc/ufw/ufw.rules" ]; then
		db_get ufw/oldrules || true
	fi

        update-rc.d ufw start 39 S . > /dev/null

        if [ ! -e "$BEFORE_FILE" ] && [ -z "$2" ]; then
            # if no config and fresh install copy the template
            cp $BEFORE_FILE_TEMPLATE /etc/ufw
        fi

        if [ ! -e "$AFTER_FILE" ] && [ -z "$2" ]; then
            # if no config and fresh install copy the template
            cp $AFTER_FILE_TEMPLATE /etc/ufw
        fi
        ;;
    abort-upgrade|abort-remove|abort-deconfigure)
        ;;
    *)
        echo "postinst called with unknown argument '$1'" >&2
        exit 1
        ;;
esac

#DEBHELPER#
