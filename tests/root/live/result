Setting IPV6 to yes
0: disable
WARN: Checks disabled
Firewall stopped and disabled on system startup


1: enable
WARN: Checks disabled
Firewall is active and enabled on system startup


TESTING ARGS (logging)
2: logging on
WARN: Checks disabled
Logging enabled


-A ufw6-after-input -m limit --limit 3/min --limit-burst 10 -j LOG --log-prefix "[UFW BLOCK INPUT]: "
-A ufw6-after-forward -m limit --limit 3/min --limit-burst 10 -j LOG --log-prefix "[UFW BLOCK FORWARD]: "
-A ufw-after-input -m limit --limit 3/min --limit-burst 10 -j LOG --log-prefix "[UFW BLOCK INPUT]: "
-A ufw-after-forward -m limit --limit 3/min --limit-burst 10 -j LOG --log-prefix "[UFW BLOCK FORWARD]: "
#-A ufw6-before-input -m state --state INVALID -j LOG --log-prefix "[UFW BLOCK INVALID]: "
#-A ufw-before-input -m state --state INVALID -j LOG --log-prefix "[UFW BLOCK INVALID]: "
-A ufw-not-local -m limit --limit 3/min --limit-burst 10 -j LOG --log-prefix "[UFW BLOCK NOT-TO-ME]: "
3: logging off
WARN: Checks disabled
Logging disabled


# ufw_comment # -A ufw6-after-input -m limit --limit 3/min --limit-burst 10 -j LOG --log-prefix "[UFW BLOCK INPUT]: "
# ufw_comment # -A ufw6-after-forward -m limit --limit 3/min --limit-burst 10 -j LOG --log-prefix "[UFW BLOCK FORWARD]: "
# ufw_comment # -A ufw-after-input -m limit --limit 3/min --limit-burst 10 -j LOG --log-prefix "[UFW BLOCK INPUT]: "
# ufw_comment # -A ufw-after-forward -m limit --limit 3/min --limit-burst 10 -j LOG --log-prefix "[UFW BLOCK FORWARD]: "
#-A ufw6-before-input -m state --state INVALID -j LOG --log-prefix "[UFW BLOCK INVALID]: "
#-A ufw-before-input -m state --state INVALID -j LOG --log-prefix "[UFW BLOCK INVALID]: "
# ufw_comment # -A ufw-not-local -m limit --limit 3/min --limit-burst 10 -j LOG --log-prefix "[UFW BLOCK NOT-TO-ME]: "
TESTING ARGS (allow/deny to/from)
4: allow 53
WARN: Checks disabled
Rule added
Rule added (v6)


5: allow 23/tcp
WARN: Checks disabled
Rule added
Rule added (v6)


6: allow smtp
WARN: Checks disabled
Rule added
Rule added (v6)


7: deny proto tcp to any port 80
WARN: Checks disabled
Rule added
Rule added (v6)


8: deny proto tcp from 10.0.0.0/8 to 192.168.0.1 port 25
WARN: Checks disabled
Rule added


9: allow from 10.0.0.0/8
WARN: Checks disabled
Rule added


10: allow from 172.16.0.0/12
WARN: Checks disabled
Rule added


11: allow from 192.168.0.0/16
WARN: Checks disabled
Rule added


12: deny proto udp from 1.2.3.4 to any port 514
WARN: Checks disabled
Rule added


13: allow proto udp from 1.2.3.5 port 5469 to 1.2.3.4 port 5469
WARN: Checks disabled
Rule added


14: limit 22/tcp
WARN: Checks disabled
Rule added
Skipping unsupported IPv6 'limit' rule


15: deny proto tcp from 2001:db8::/32 to any port 25
WARN: Checks disabled
Rule added (v6)


16: deny from 2001:db8::/32 port 26 to 2001:db8:3:4:5:6:7:8
WARN: Checks disabled
Rule added (v6)


17: status
WARN: Checks disabled
Status: active

To                         Action  From
--                         ------  ----
53/tcp                     ALLOW   Anywhere
53/udp                     ALLOW   Anywhere
23/tcp                     ALLOW   Anywhere
25/tcp                     ALLOW   Anywhere
80/tcp                     DENY    Anywhere
192.168.0.1 25/tcp         DENY    10.0.0.0/8
Anywhere                   ALLOW   10.0.0.0/8
Anywhere                   ALLOW   172.16.0.0/12
Anywhere                   ALLOW   192.168.0.0/16
514/udp                    DENY    1.2.3.4
1.2.3.4 5469/udp           ALLOW   1.2.3.5 5469/udp
22/tcp                     LIMIT   Anywhere
53/tcp                     ALLOW   Anywhere (v6)
53/udp                     ALLOW   Anywhere (v6)
23/tcp                     ALLOW   Anywhere (v6)
25/tcp                     ALLOW   Anywhere (v6)
80/tcp                     DENY    Anywhere (v6)
25/tcp                     DENY    2001:db8::/32
2001:db8:3:4:5:6:7:8/128   DENY    2001:db8::/32 26/tcp
2001:db8:3:4:5:6:7:8/128   DENY    2001:db8::/32 26/udp



### tuple ### allow any 53 0.0.0.0/0 any 0.0.0.0/0
-A ufw-user-input -p tcp --dport 53 -j ACCEPT
-A ufw-user-input -p udp --dport 53 -j ACCEPT
--
### tuple ### allow tcp 23 0.0.0.0/0 any 0.0.0.0/0
-A ufw-user-input -p tcp --dport 23 -j ACCEPT

### tuple ### allow tcp 25 0.0.0.0/0 any 0.0.0.0/0
-A ufw-user-input -p tcp --dport 25 -j ACCEPT

### tuple ### deny tcp 80 0.0.0.0/0 any 0.0.0.0/0
-A ufw-user-input -p tcp --dport 80 -j DROP

### tuple ### deny tcp 25 192.168.0.1 any 10.0.0.0/8
-A ufw-user-input -p tcp -d 192.168.0.1 --dport 25 -s 10.0.0.0/8 -j DROP

### tuple ### allow any any 0.0.0.0/0 any 10.0.0.0/8
-A ufw-user-input -s 10.0.0.0/8 -j ACCEPT

### tuple ### allow any any 0.0.0.0/0 any 172.16.0.0/12
-A ufw-user-input -s 172.16.0.0/12 -j ACCEPT

### tuple ### allow any any 0.0.0.0/0 any 192.168.0.0/16
-A ufw-user-input -s 192.168.0.0/16 -j ACCEPT

### tuple ### deny udp 514 0.0.0.0/0 any 1.2.3.4
-A ufw-user-input -p udp --dport 514 -s 1.2.3.4 -j DROP

### tuple ### allow udp 5469 1.2.3.4 5469 1.2.3.5
-A ufw-user-input -p udp -d 1.2.3.4 --dport 5469 -s 1.2.3.5 --sport 5469 -j ACCEPT

### tuple ### limit tcp 22 0.0.0.0/0 any 0.0.0.0/0
-A ufw-user-input -p tcp --dport 22 -m state --state NEW -m recent --set
-A ufw-user-input -p tcp --dport 22 -m state --state NEW -m recent --update --seconds 30 --hitcount 6 -j ufw-user-limit
### tuple ### allow any 53 ::/0 any ::/0
-A ufw6-user-input -p tcp --dport 53 -j ACCEPT
-A ufw6-user-input -p udp --dport 53 -j ACCEPT
--
### tuple ### allow tcp 23 ::/0 any ::/0
-A ufw6-user-input -p tcp --dport 23 -j ACCEPT

### tuple ### allow tcp 25 ::/0 any ::/0
-A ufw6-user-input -p tcp --dport 25 -j ACCEPT

### tuple ### deny tcp 80 ::/0 any ::/0
-A ufw6-user-input -p tcp --dport 80 -j DROP

### tuple ### deny tcp 25 ::/0 any 2001:db8::/32
-A ufw6-user-input -p tcp --dport 25 -s 2001:db8::/32 -j DROP

### tuple ### deny any any 2001:db8:3:4:5:6:7:8 26 2001:db8::/32
-A ufw6-user-input -p tcp -d 2001:db8:3:4:5:6:7:8 -s 2001:db8::/32 --sport 26 -j DROP
-A ufw6-user-input -p udp -d 2001:db8:3:4:5:6:7:8 -s 2001:db8::/32 --sport 26 -j DROP
TESTING ARGS (delete allow/deny to/from)
18: delete allow 53
WARN: Checks disabled
Rule deleted
Rule deleted (v6)


19: delete allow 23/tcp
WARN: Checks disabled
Rule deleted
Rule deleted (v6)


20: delete allow smtp
WARN: Checks disabled
Rule deleted
Rule deleted (v6)


21: delete deny proto tcp to any port 80
WARN: Checks disabled
Rule deleted
Rule deleted (v6)


22: delete deny proto tcp from 10.0.0.0/8 to 192.168.0.1 port 25
WARN: Checks disabled
Rule deleted


23: delete allow from 10.0.0.0/8
WARN: Checks disabled
Rule deleted


24: delete allow from 172.16.0.0/12
WARN: Checks disabled
Rule deleted


25: delete allow from 192.168.0.0/16
WARN: Checks disabled
Rule deleted


26: delete deny proto udp from 1.2.3.4 to any port 514
WARN: Checks disabled
Rule deleted


27: delete allow proto udp from 1.2.3.5 port 5469 to 1.2.3.4 port 5469
WARN: Checks disabled
Rule deleted


28: delete limit 22/tcp
WARN: Checks disabled
Rule deleted
Skipping unsupported IPv6 'limit' rule


29: delete deny proto tcp from 2001:db8::/32 to any port 25
WARN: Checks disabled
Rule deleted (v6)


30: delete deny from 2001:db8::/32 port 26 to 2001:db8:3:4:5:6:7:8
WARN: Checks disabled
Rule deleted (v6)


31: status
WARN: Checks disabled
Status: active


Setting IPV6 to no
32: disable
WARN: Checks disabled
Firewall stopped and disabled on system startup


33: enable
WARN: Checks disabled
Firewall is active and enabled on system startup


TESTING ARGS (logging)
34: logging on
WARN: Checks disabled
Logging enabled


-A ufw6-after-input -m limit --limit 3/min --limit-burst 10 -j LOG --log-prefix "[UFW BLOCK INPUT]: "
-A ufw6-after-forward -m limit --limit 3/min --limit-burst 10 -j LOG --log-prefix "[UFW BLOCK FORWARD]: "
-A ufw-after-input -m limit --limit 3/min --limit-burst 10 -j LOG --log-prefix "[UFW BLOCK INPUT]: "
-A ufw-after-forward -m limit --limit 3/min --limit-burst 10 -j LOG --log-prefix "[UFW BLOCK FORWARD]: "
#-A ufw6-before-input -m state --state INVALID -j LOG --log-prefix "[UFW BLOCK INVALID]: "
#-A ufw-before-input -m state --state INVALID -j LOG --log-prefix "[UFW BLOCK INVALID]: "
-A ufw-not-local -m limit --limit 3/min --limit-burst 10 -j LOG --log-prefix "[UFW BLOCK NOT-TO-ME]: "
35: logging off
WARN: Checks disabled
Logging disabled


# ufw_comment # -A ufw6-after-input -m limit --limit 3/min --limit-burst 10 -j LOG --log-prefix "[UFW BLOCK INPUT]: "
# ufw_comment # -A ufw6-after-forward -m limit --limit 3/min --limit-burst 10 -j LOG --log-prefix "[UFW BLOCK FORWARD]: "
# ufw_comment # -A ufw-after-input -m limit --limit 3/min --limit-burst 10 -j LOG --log-prefix "[UFW BLOCK INPUT]: "
# ufw_comment # -A ufw-after-forward -m limit --limit 3/min --limit-burst 10 -j LOG --log-prefix "[UFW BLOCK FORWARD]: "
#-A ufw6-before-input -m state --state INVALID -j LOG --log-prefix "[UFW BLOCK INVALID]: "
#-A ufw-before-input -m state --state INVALID -j LOG --log-prefix "[UFW BLOCK INVALID]: "
# ufw_comment # -A ufw-not-local -m limit --limit 3/min --limit-burst 10 -j LOG --log-prefix "[UFW BLOCK NOT-TO-ME]: "
TESTING ARGS (allow/deny to/from)
36: allow 53
WARN: Checks disabled
Rule added


37: allow 23/tcp
WARN: Checks disabled
Rule added


38: allow smtp
WARN: Checks disabled
Rule added


39: deny proto tcp to any port 80
WARN: Checks disabled
Rule added


40: deny proto tcp from 10.0.0.0/8 to 192.168.0.1 port 25
WARN: Checks disabled
Rule added


41: allow from 10.0.0.0/8
WARN: Checks disabled
Rule added


42: allow from 172.16.0.0/12
WARN: Checks disabled
Rule added


43: allow from 192.168.0.0/16
WARN: Checks disabled
Rule added


44: deny proto udp from 1.2.3.4 to any port 514
WARN: Checks disabled
Rule added


45: allow proto udp from 1.2.3.5 port 5469 to 1.2.3.4 port 5469
WARN: Checks disabled
Rule added


46: limit 22/tcp
WARN: Checks disabled
Rule added


47: status
WARN: Checks disabled
Status: active

To                         Action  From
--                         ------  ----
53/tcp                     ALLOW   Anywhere
53/udp                     ALLOW   Anywhere
23/tcp                     ALLOW   Anywhere
25/tcp                     ALLOW   Anywhere
80/tcp                     DENY    Anywhere
192.168.0.1 25/tcp         DENY    10.0.0.0/8
Anywhere                   ALLOW   10.0.0.0/8
Anywhere                   ALLOW   172.16.0.0/12
Anywhere                   ALLOW   192.168.0.0/16
514/udp                    DENY    1.2.3.4
1.2.3.4 5469/udp           ALLOW   1.2.3.5 5469/udp
22/tcp                     LIMIT   Anywhere



### tuple ### allow any 53 0.0.0.0/0 any 0.0.0.0/0
-A ufw-user-input -p tcp --dport 53 -j ACCEPT
-A ufw-user-input -p udp --dport 53 -j ACCEPT
--
### tuple ### allow tcp 23 0.0.0.0/0 any 0.0.0.0/0
-A ufw-user-input -p tcp --dport 23 -j ACCEPT

### tuple ### allow tcp 25 0.0.0.0/0 any 0.0.0.0/0
-A ufw-user-input -p tcp --dport 25 -j ACCEPT

### tuple ### deny tcp 80 0.0.0.0/0 any 0.0.0.0/0
-A ufw-user-input -p tcp --dport 80 -j DROP

### tuple ### deny tcp 25 192.168.0.1 any 10.0.0.0/8
-A ufw-user-input -p tcp -d 192.168.0.1 --dport 25 -s 10.0.0.0/8 -j DROP

### tuple ### allow any any 0.0.0.0/0 any 10.0.0.0/8
-A ufw-user-input -s 10.0.0.0/8 -j ACCEPT

### tuple ### allow any any 0.0.0.0/0 any 172.16.0.0/12
-A ufw-user-input -s 172.16.0.0/12 -j ACCEPT

### tuple ### allow any any 0.0.0.0/0 any 192.168.0.0/16
-A ufw-user-input -s 192.168.0.0/16 -j ACCEPT

### tuple ### deny udp 514 0.0.0.0/0 any 1.2.3.4
-A ufw-user-input -p udp --dport 514 -s 1.2.3.4 -j DROP

### tuple ### allow udp 5469 1.2.3.4 5469 1.2.3.5
-A ufw-user-input -p udp -d 1.2.3.4 --dport 5469 -s 1.2.3.5 --sport 5469 -j ACCEPT

### tuple ### limit tcp 22 0.0.0.0/0 any 0.0.0.0/0
-A ufw-user-input -p tcp --dport 22 -m state --state NEW -m recent --set
-A ufw-user-input -p tcp --dport 22 -m state --state NEW -m recent --update --seconds 30 --hitcount 6 -j ufw-user-limit
TESTING ARGS (delete allow/deny to/from)
48: delete allow 53
WARN: Checks disabled
Rule deleted


49: delete allow 23/tcp
WARN: Checks disabled
Rule deleted


50: delete allow smtp
WARN: Checks disabled
Rule deleted


51: delete deny proto tcp to any port 80
WARN: Checks disabled
Rule deleted


52: delete deny proto tcp from 10.0.0.0/8 to 192.168.0.1 port 25
WARN: Checks disabled
Rule deleted


53: delete allow from 10.0.0.0/8
WARN: Checks disabled
Rule deleted


54: delete allow from 172.16.0.0/12
WARN: Checks disabled
Rule deleted


55: delete allow from 192.168.0.0/16
WARN: Checks disabled
Rule deleted


56: delete deny proto udp from 1.2.3.4 to any port 514
WARN: Checks disabled
Rule deleted


57: delete allow proto udp from 1.2.3.5 port 5469 to 1.2.3.4 port 5469
WARN: Checks disabled
Rule deleted


58: delete limit 22/tcp
WARN: Checks disabled
Rule deleted


59: status
WARN: Checks disabled
Status: active


Checking status
60: status


61: status verbose


62: status raw


Checking reject
Setting IPV6 to yes
63: disable
WARN: Checks disabled
Firewall stopped and disabled on system startup


64: enable
WARN: Checks disabled
Firewall is active and enabled on system startup


65: reject 113
WARN: Checks disabled
Rule added
Rule added (v6)


66: reject 114/tcp
WARN: Checks disabled
Rule added
Rule added (v6)


67: reject 115/udp
WARN: Checks disabled
Rule added
Rule added (v6)


68: status
WARN: Checks disabled
Status: active

To                         Action  From
--                         ------  ----
113/tcp                    REJECT  Anywhere
113/udp                    REJECT  Anywhere
114/tcp                    REJECT  Anywhere
115/udp                    REJECT  Anywhere
113/tcp                    REJECT  Anywhere (v6)
113/udp                    REJECT  Anywhere (v6)
114/tcp                    REJECT  Anywhere (v6)
115/udp                    REJECT  Anywhere (v6)



### tuple ### reject any 113 0.0.0.0/0 any 0.0.0.0/0
-A ufw-user-input -p tcp --dport 113 -j REJECT --reject-with tcp-reset 
-A ufw-user-input -p udp --dport 113 -j REJECT
--
### tuple ### reject tcp 114 0.0.0.0/0 any 0.0.0.0/0
-A ufw-user-input -p tcp --dport 114 -j REJECT --reject-with tcp-reset

### tuple ### reject udp 115 0.0.0.0/0 any 0.0.0.0/0
-A ufw-user-input -p udp --dport 115 -j REJECT

### tuple ### reject any 113 ::/0 any ::/0
-A ufw6-user-input -p tcp --dport 113 -j REJECT --reject-with tcp-reset 
-A ufw6-user-input -p udp --dport 113 -j REJECT
--
### tuple ### reject tcp 114 ::/0 any ::/0
-A ufw6-user-input -p tcp --dport 114 -j REJECT --reject-with tcp-reset

### tuple ### reject udp 115 ::/0 any ::/0
-A ufw6-user-input -p udp --dport 115 -j REJECT

69: delete reject 113
WARN: Checks disabled
Rule deleted
Rule deleted (v6)


70: delete reject 114/tcp
WARN: Checks disabled
Rule deleted
Rule deleted (v6)


71: delete reject 115/udp
WARN: Checks disabled
Rule deleted
Rule deleted (v6)


72: status
WARN: Checks disabled
Status: active


Setting IPV6 to no
73: disable
WARN: Checks disabled
Firewall stopped and disabled on system startup


74: enable
WARN: Checks disabled
Firewall is active and enabled on system startup


75: reject 113
WARN: Checks disabled
Rule added


76: reject 114/tcp
WARN: Checks disabled
Rule added


77: reject 115/udp
WARN: Checks disabled
Rule added


78: status
WARN: Checks disabled
Status: active

To                         Action  From
--                         ------  ----
113/tcp                    REJECT  Anywhere
113/udp                    REJECT  Anywhere
114/tcp                    REJECT  Anywhere
115/udp                    REJECT  Anywhere



### tuple ### reject any 113 0.0.0.0/0 any 0.0.0.0/0
-A ufw-user-input -p tcp --dport 113 -j REJECT --reject-with tcp-reset 
-A ufw-user-input -p udp --dport 113 -j REJECT
--
### tuple ### reject tcp 114 0.0.0.0/0 any 0.0.0.0/0
-A ufw-user-input -p tcp --dport 114 -j REJECT --reject-with tcp-reset

### tuple ### reject udp 115 0.0.0.0/0 any 0.0.0.0/0
-A ufw-user-input -p udp --dport 115 -j REJECT

79: delete reject 113
WARN: Checks disabled
Rule deleted


80: delete reject 114/tcp
WARN: Checks disabled
Rule deleted


81: delete reject 115/udp
WARN: Checks disabled
Rule deleted


82: status
WARN: Checks disabled
Status: active


Checking flush builtins
83: disable
WARN: Checks disabled
Firewall stopped and disabled on system startup


iptables -I INPUT -j ACCEPT -m comment --comment ufw_test_builtins
84: enable
WARN: Checks disabled
Firewall is active and enabled on system startup


85: disable
WARN: Checks disabled
Firewall stopped and disabled on system startup


iptables -I INPUT -j ACCEPT -m comment --comment ufw_test_builtins
86: enable
WARN: Checks disabled
Firewall is active and enabled on system startup


ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0           /* ufw_test_builtins */ 
87: disable
WARN: Checks disabled
Firewall stopped and disabled on system startup


